/*c80b0825c8dd667352c353d73fca42e11fcc3cae*/Ext.define("Ext.data.proxy.OData",{extend:"Ext.data.proxy.Rest",alias:"proxy.odata",requires:["Ext.XTemplate","Ext.data.reader.Xml","Ext.data.writer.Xml","Ext.data.Connection"],statics:{connection:Ext.create("Ext.data.Connection")},config:{startParam:"$skip",limitParam:"$top",groupParam:null,pageParam:null,format:"xml",useHeaderAuthentication:false,xmlDocumentTpl:['<?xml version="1.0" encoding="utf-8"?>\n',"<atom:entry \n",'            xmlns:atom="http://www.w3.org/2005/Atom"\n','            xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices"\n','            xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"\n','            xmlns:sap="http://www.sap.com/Protocols/SAPData">\n','    <atom:content type="application/xml">\n',"        <m:properties>",'          <tpl for=".">\n','           <tpl if="value === null">','            <d:{key} m:null="true"/>',"           <tpl else>","            <d:{key}>{value}</d:{key}>","           </tpl>","          </tpl>\n","        </m:properties>\n","    </atom:content>\n","</atom:entry>\n"],enablePagingParams:true,timeout:30000,extraParams:{},headers:{},actionMethods:{create:"POST",read:"GET",update:"PUT",destroy:"DELETE"},reader:{type:"xml",implicitIncludes:false,record:"entry"},writer:{type:"xml"},noCache:false,appendId:false},applyXmlDocumentTpl:function(b){if(b&&!b.isTemplate){return Ext.create("Ext.XTemplate",b)}return b},prepareXmlData:function(o){var q=this.getWriter(),p=o.getOperation(),r=p.getRecords()||[],s=this.getXmlDocumentTpl(),l=p.getModel(),t=l.getIdProperty(),v=[],n,m,u;if(r.length){n=q.getRecordData(r[0])}if(n){for(u in n){if(u!==t&&n.hasOwnProperty(u)){v.push({key:u,value:n[u]})}}m=s.apply(v)}return m},doRequest:function(l,p,o){var r=this,m=l.getAction(),t=r.getUsername(),q=r.getPassword(),k=r.buildRequest(l),n=Ext.applyIf({},r.getHeaders()),s=r.self.connection.getDefaultHeaders()||{};k.setConfig({headers:n,timeout:r.getTimeout(),method:r.getMethod(k),callback:r.createRequestCallback(k,l,p,o),scope:r,proxy:r});if((l.getWithCredentials()||r.getWithCredentials())&&!Ext.isEmpty(t)){if(this.getUseHeaderAuthentication()){n.Authorization="Basic "+window.btoa(t+":"+q)}else{k.setWithCredentials(true);k.setUsername(t);k.setPassword(q)}}if(!s["x-csrf-token"]){n["x-csrf-token"]="Fetch"}if(m==="create"||m==="update"){n["Content-Type"]="application/atom+xml";k.setXmlData(this.prepareXmlData(k))}if(m==="destroy"||m==="update"){n["If-Match"]="*"}r.self.connection.request(k.getCurrentConfig());return k},buildUrl:function(k){var l=this,n=k.getOperation().getRecords()||[],h=n[0],m=l.getModel().getIdProperty(),j=k.getParams()||{},i=(h&&!h.phantom)?h.getId():j[m];delete j[m];return i||l.getUrl(k)},processResponse:function(k,q,o,p,l,j){var m=this,r=q.getAction(),n=m.self.connection.getDefaultHeaders()||{};if(r==="read"){if(!n["x-csrf-token"]){n["x-csrf-token"]=p.getResponseHeader("x-csrf-token");m.self.connection.setDefaultHeaders(n)}this.callParent(arguments)}else{if(r==="create"){this.callParent(arguments)}else{q.setCompleted(true);if(p.status!==204){q.setSuccessful(false);q.setException(p.statusText);m.fireEvent("exception",this,p,q)}if(typeof l=="function"){l.call(j||m,q)}}}}});